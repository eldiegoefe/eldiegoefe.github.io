<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8"> 
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="El Diego Efe" />
        <meta name="copyright" content="El Diego Efe" />

        <meta name="description" content="RSync es un programa que permite copiar archivos, pero a diferencia de un copiado común, compara los archivos de origen y destino y sólo realiza la transferencia de la diferencia entre ambos: si son iguales no transfiere nada, si es un archivo de texto y se agregó sólo un caracter …
" />
<meta name="keywords" content="rsync, backup, tecnicismos, " />
        <title>Backup con&nbsp;RSync  · Certezas Dudosas
</title>
        <link href="https://cdn-images.mailchimp.com/embedcode/slim-081711.css" rel="stylesheet" type="text/css">
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="https://eldiegoefe.github.io/theme/css/style.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://eldiegoefe.github.io/theme/css/solarizedlight.css" media="screen">
        <link rel="shortcut icon" href="https://eldiegoefe.github.io/theme/images/favicon.ico" type="image/x-icon" />
        <link rel="apple-touch-icon" href="https://eldiegoefe.github.io/theme/images/apple-touch-icon.png" />
        <link rel="apple-touch-icon" sizes="57x57" href="https://eldiegoefe.github.io/theme/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon" sizes="72x72" href="https://eldiegoefe.github.io/theme/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon" sizes="114x114" href="https://eldiegoefe.github.io/theme/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon" sizes="144x144" href="https://eldiegoefe.github.io/theme/images/apple-touch-icon-144x144.png" />
        <link rel="icon" href="https://eldiegoefe.github.io/theme/images/apple-touch-icon-144x144.png" />
        <link href="https://eldiegoefe.github.io/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Certezas Dudosas - Full RSS Feed" />
        <link href="https://eldiegoefe.github.io/feeds/blog.rss.xml" type="application/atom+xml" rel="alternate" title="Certezas Dudosas - blog Category RSS Feed" />
        <link href="https://eldiegoefe.github.io/feeds/politica.rss.xml" type="application/atom+xml" rel="alternate" title="Certezas Dudosas - politica Category RSS Feed" />
        <link href="https://eldiegoefe.github.io/feeds/salud.rss.xml" type="application/atom+xml" rel="alternate" title="Certezas Dudosas - salud Category RSS Feed" />
        <link href="https://eldiegoefe.github.io/feeds/tecnicismos.rss.xml" type="application/atom+xml" rel="alternate" title="Certezas Dudosas - tecnicismos Category RSS Feed" />
    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="https://eldiegoefe.github.io/"><span class=site-name>Certezas Dudosas</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="https://eldiegoefe.github.io">Home</a></li>
                            <li ><a href="https://eldiegoefe.github.io/categories.html">Categories</a></li>
                            <li ><a href="https://eldiegoefe.github.io/tags.html">Tags</a></li>
                            <li ><a href="https://eldiegoefe.github.io/archives.html">Archives</a></li>
                            <li><form class="navbar-search" action="https://eldiegoefe.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article>
<div class="row-fluid">
    <header class="page_header span10 offset2">
    <h1><a href="https://eldiegoefe.github.io/backup-con-rsync.html"> Backup con&nbsp;RSync  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            <p>RSync es un programa que permite copiar archivos, pero a diferencia de un
copiado común, compara los archivos de origen y destino y sólo realiza la
transferencia de la diferencia entre ambos: si son iguales no transfiere nada,
si es un archivo de texto y se agregó sólo un caracter, RSync envía unicamente
ese caracter y reconstruye el archivo en el destino para que ambas copias sean
exactamente iguales. De este modo el procedimiento es más eficiente, en
particular si se copian archivos grandes. La copia se puede realizar entre
cualquier directorio de origen y destino, ya sea que se encuentren en un mismo
disco rígido, en diferentes discos en una misma computadora o también entre
una máquina local y una remota (o&nbsp;viceversa).</p>
<p>Poder copiar de este modo es óptimo para realizar backups de nuestros datos.
Como se pueden copiar directorios recursivamente entonces es muy facil, por
ejemplo, mantener una copia actualizada de una colección de fotos, que
generalmente tiene muchos subdirectorios para almacenar imágenes ordenadas por
fecha o por temática. Es RSync el que compara el contenido de cada
subdirectorio, y por ejemplo si le cambiamos el contraste a una foto, lo detecta
y actualiza en la copia de destino. Nos ahorra tener que identificar cuál es el
archivo que procesamos, y todo con una sola linea de comandos, que ya&nbsp;veremos&#8230;</p>
<p>Primero tenemos que saber la ubicación de los archivos que queremos copiar y el
camino hacia el lugar donde haremos la copia. Para esta tarea podemos usar el
comando df, que muestra el espacio libre en cada sistema de archivos que se
encuentra montado en el sistema y también informa el punto de montaje. El
modificador <em>-h</em> (la forma corta de <em>&#8212;human-readable</em>) ofrece el resultado en
potencias de&nbsp;1024.</p>
<div class="highlight"><pre><span></span><span class="gp">$</span> df -h

<span class="go">S.ficheros     Tamaño Usados  Disp Uso% Montado en</span>
<span class="go">udev             3,9G      0  3,9G   0% /dev</span>
<span class="go">tmpfs            784M   9,7M  775M   2% /run</span>
<span class="go">/dev/sda4         49G    23G   24G  50% /</span>
<span class="go">tmpfs            3,9G   237M  3,6G   7% /dev/shm</span>
<span class="go">tmpfs            5,0M   4,0K  5,0M   1% /run/lock</span>
<span class="go">tmpfs            3,9G      0  3,9G   0% /sys/fs/cgroup</span>
<span class="go">/dev/sda2        1,3G   500M  705M  42% /boot</span>
<span class="go">/dev/sda5        853G   402G  408G  50% /home</span>
<span class="go">cgmfs            100K      0  100K   0% /run/cgmanager/fs</span>
<span class="go">tmpfs            784M    16K  784M   1% /run/user/1001</span>
<span class="go">/dev/sdc1        932G   912G   21G  98% /media/diego/biblioteca</span>
</pre></div>
<p>En el ejemplo pueden ver mi directorio de origen (que son archivos ubicados
en /home) y el destino será algún subdirectorio en el disco rígido externo, que
se encuentra montado en /media/diego/biblioteca (me está quedando poco&nbsp;espacio&#8230;).</p>
<p>También se puede utilizar el comando <em>lsblk</em> para obtener información sobre los
discos&nbsp;montados:</p>
<div class="highlight"><pre><span></span>$ lsblk

NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
sda      8:0    0 931,5G  0 disk
├─sda1   8:1    0    20M  0 part
├─sda2   8:2    0   1,3G  0 part /boot
├─sda3   8:3    0  15,3G  0 part [SWAP]
├─sda4   8:4    0    49G  0 part /
└─sda5   8:5    0 865,9G  0 part /home
sdb      8:16   0 119,2G  0 disk
├─sdb1   8:17   0   100M  0 part
├─sdb2   8:18   0 118,7G  0 part
└─sdb3   8:19   0   450M  0 part
sdc      8:32   0 931,5G  0 disk
└─sdc1   8:33   0 931,5G  0 part /media/diego/biblioteca
sdd      8:48   0 931,5G  0 disk
</pre></div>
<p>Generalmente el comando RSync se ejecuta con estos&nbsp;modificadores:</p>
<div class="highlight"><pre><span></span>$ rsync -avh --progress --delete /desde /hacia
</pre></div>
<p>Donde:</p>
<ul class="simple">
<li><strong>a</strong>: archive, es un modificador que se usa generalmente. Es una abreviatura para
no tener que poner todos estos otros modificadores -rlptgoD. Sirve para
asegurar que en la transferencia se preserven los symbolic links,
dispositivos, atributos, permisos, ownerships,&nbsp;etc.</li>
<li><strong>v</strong>:&nbsp;verbose</li>
<li><strong>h</strong>: human&nbsp;readable.</li>
<li><strong>progress</strong>: muestra el progreso de la&nbsp;transferencia.</li>
<li><strong>delete</strong>: borra los archivos en destino que no están en el&nbsp;origen.</li>
<li><strong>/desde</strong>: directorio de&nbsp;origen</li>
<li><strong>/hacia</strong>: directorio de&nbsp;destino</li>
</ul>
<p>Leyendo el manual de RSync encontramos dos modos distintos de copiar un
directorio hacia un destino, siendo la diferencia el uso de un <em>trailing slash</em>
(el símbolo&nbsp;/):</p>
<div class="highlight"><pre><span></span>rsync -av /src/foo /dest
rsync -av /src/foo/ /dest/foo
</pre></div>
<p>En el primer caso se copia el directorio foo dentro del directorio destino dest.
En cambio con el trailing slash indicamos que lo que se copia es el contenido
del directorio foo, y entonces para mantener la estructura en el destino,
debemos copiarlo dentro de un directorio foo (no directamente en&nbsp;dest).</p>
<p>Para copiar todas mis fotos, lo que tengo que hacer es crear (por única vez) un
directorio para tal efecto en el disco&nbsp;externo:</p>
<div class="highlight"><pre><span></span>$ mkdir /media/diego/biblioteca/fotos
</pre></div>
<p>Para efectuar la copia de las fotos que tengo ubicadas dentro de /home/diego/fotos,
el comando&nbsp;será:</p>
<div class="highlight"><pre><span></span>$ rsync -avh --progress --delete ~/imagenes/ /media/diego/biblioteca/fotos
</pre></div>
<p>La primera vez que ejecute esta orden consumirá más tiempo porque RSync debe
copiar todos los archivos, ya que el destino estaba vacío. Sin embargo, en
ejecuciones posteriores se compararán los directorios de origen y destino, y
sólo se copiará aquello que haya cambiado (o se borrarán aquellos archivos en el
directorio de destino que se hayan eliminado del directorio de origen). Con este
modo de hacer backup, me cambió la&nbsp;vida.</p>

<section>
<p id="comment-message">No te vayas sin comentar algo del post, de las noticias del día, del clima, que se yo... </p>
<div class="accordion" id="accordion2">
    <div class="accordion-group">
        <div class="accordion-heading">
            <a class="accordion-toggle disqus-comment-count" data-toggle="collapse" data-parent="#accordion2"
                    data-disqus-identifier="Backup con RSync"
                href="https://eldiegoefe.github.io/backup-con-rsync.html#disqus_thread">
                Comments
            </a>
        </div>
        <div id="disqus_thread" class="accordion-body collapse">
            <div class="accordion-inner">
                <div class="comments">
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'certezasdudosas';
        var disqus_identifier = 'Backup con RSync';
    var disqus_url = 'https://eldiegoefe.github.io/backup-con-rsync.html';

    (function() {
         var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
         dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
         (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>                </div>
            </div>
        </div>
    </div>
</div>
</section>
            <aside>
            <hr/>
            <nav>
            <ul class="articles_timeline">
 
                <li class="previous_article">« <a href="https://eldiegoefe.github.io/ciencia-con-problemas-capitales.html" title="Previous: Ciencia con problemas&nbsp;capitales">Ciencia con problemas&nbsp;capitales</a></li>
            </ul>
            </nav>
            </aside>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
 
            <h4>Published</h4>
            <time pubdate="pubdate" datetime="2017-06-21T10:00:00-03:00">jun 21, 2017</time>
            <h4>Category</h4>
            <a class="category-link" href="/categories.html#tecnicismos-ref">tecnicismos</a> 
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article"> 
                <li><a href="/tags.html#backup-ref">backup
                    <span>1</span>
</a></li>
                <li><a href="/tags.html#rsync-ref">rsync
                    <span>1</span>
</a></li>
            </ul>

        </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-subtitle"><span class="site-name">Certezas Dudosas</span> - todo lo liquido se desvanece en el estomago</li>
        <li class="elegant-license">Podes usar el contenido de este blog si pones un link hacia https://eldiegoefe.github.io/</li>
        <li class="elegant-power">Powered by <a href="https://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="https://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="https://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a></li>
    </ul>
</div>
</footer>            <script src="https://code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

<script type="text/javascript">
    var disqus_shortname = 'certezasdudosas';

    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
    </script>
        <script  language="javascript" type="text/javascript">
            function uncollapse() {
                var hash_str = window.location.hash;
                if (window.location.hash.match(/^#comment-\d+$/))
                {
                    var hash_str = '#disqus_thread';
                }
                $(hash_str).collapse({
                    toggle: true
                    })
            }
        </script>

        <script type="text/javascript" language="JavaScript">
            uncollapse(); 
        </script>
    </body>
</html>